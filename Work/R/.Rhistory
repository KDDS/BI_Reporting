values = c("red", "#0072B2")
) +
theme_bw(base_size = 15)  + theme(panel.background = element_rect(
linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed'
)) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())  +  scale_x_date(date_breaks = 'day',
date_labels = '%b %d\n%a')
ggplot(data = data_temp, aes(y = WORK_HOURS, x = WORK_DATE)) +
geom_point(
shape = 20,
size = 5,
aes(color = ifelse(
data_temp$WORK_HOURS <= 8 & data_temp$WORK_HOURS > 3 , Ok, defaulter
)),
show.legend = T
) +
scale_color_manual(
labels = c("Default", "Success"),
values = c("red", "#0072B2")
) +
theme_bw(base_size = 15)  + theme(panel.background = element_rect(
linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed'
)) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())  +  scale_x_date(date_breaks = 'day',
date_labels = '%b %d\n%a')
View(data_temp)
runApp()
data_temp  = sqlQuery(connHandle, "
SELECT da.agent_name,dw.week_day,ds.shift_type,df.contact_date,TOTAL_CONNECTED_IN_HRS,
TOTAL_WAITING_IN_HRS,
TOTAL_PAUSED_IN_HRS,
TOTAL_DEASSIGN_IN_HRS,
TOTAL_SUMMARY_IN_HRS,
TOTAL_CONNECTED_IN_MINS,
TOTAL_WAITING_IN_MINS,
TOTAL_PAUSED_IN_MINS,
TOTAL_DEASSIGN_IN_MINS,
TOTAL_SUMMARY_IN_MINS from
DIM_AGENT DA,
dim_shifts ds,
dim_weeks dw,
daily_noble_data_fact df
WHERE df.agent_id =DA.agent_id
and ds.shift_id=df.shift_id
and dw.week_id = df.week_id
AND df.CONTACT_DATE >= TO_DATE(SYSDATE - 7, 'mm/dd/yyyy');",stringsAsFactors = T
)
data_temp$CONTACT_DATE <- as.Date(data_temp$CONTACT_DATE, "%m/%d/%Y")
data_left_pgOne <-  data_temp %>%
select (.,AGENT_NAME,TOTAL_SUMMARY_IN_HRS,CONTACT_DATE)%>%
group_by(AGENT_NAME, CONTACT_DATE) %>% mutate(cumsum(TOTAL_SUMMARY_IN_HRS))
View(data_left_pgOne)
data_left_pgOne <-  data_temp %>%
select (.,AGENT_NAME,TOTAL_SUMMARY_IN_HRS,CONTACT_DATE)%>%
group_by(AGENT_NAME, CONTACT_DATE) %>% summarise_each(funs(sum))
summarise_at(vars(TOTAL_SUMMARY_IN_HRS), funs(sum(., na.rm = TRUE))
data_left_pgOne <-  data_temp %>%
select (.,AGENT_NAME,TOTAL_SUMMARY_IN_HRS,CONTACT_DATE)%>%
group_by(AGENT_NAME, CONTACT_DATE) %>%
summarise_at(vars(TOTAL_SUMMARY_IN_HRS), funs(sum(., na.rm = TRUE)))
data_left_pgOne <-  data_temp %>%
select (.,AGENT_NAME,TOTAL_SUMMARY_IN_HRS,CONTACT_DATE)%>%
group_by(AGENT_NAME, CONTACT_DATE) %>%
summarise_at(vars(TOTAL_SUMMARY_IN_HRS), funs(sum()))
data_left_pgOne <-  data_temp %>%
select (.,AGENT_NAME,TOTAL_SUMMARY_IN_HRS,CONTACT_DATE)%>%
group_by(AGENT_NAME, CONTACT_DATE) %>%
summarise_at(vars(TOTAL_SUMMARY_IN_HRS), funs(sum()))
data_left_pgOne <-  data_temp %>%
select (.,AGENT_NAME,TOTAL_SUMMARY_IN_HRS,CONTACT_DATE)%>%
group_by(AGENT_NAME, CONTACT_DATE) %>%
summarise(Total = sum(TOTAL_SUMMARY_IN_HRS, na.rm = TRUE))
data_left_pgOne <-  data_temp %>%
select (.,AGENT_NAME,TOTAL_SUMMARY_IN_HRS,CONTACT_DATE)%>%
group_by(AGENT_NAME, CONTACT_DATE) %>%
summarise(WORK_HOURS = sum(TOTAL_SUMMARY_IN_HRS, na.rm = TRUE))
ggplot(data = data_left_pgOne, aes(y = WORK_HOURS, x = CONTACT_DATE)) +
geom_point(
shape = 20,
size = 5,
aes(color = ifelse(
data_temp$WORK_HOURS <= 8 , Ok, defaulter
)),
show.legend = T
) +
scale_color_manual(
labels = c("Default", "Success"),
values = c("red", "#0072B2")
) +
theme_bw(base_size = 15)  + theme(panel.background = element_rect(
linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed'
)) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())  +  scale_x_date(date_breaks = 'day',
date_labels = '%b %d\n%a')
ggplot(data = data_left_pgOne, aes(x = CONTACT_DATE,y = WORK_HOURS)) +
geom_point(
shape = 20,
size = 5,
aes(color = ifelse(
data_temp$WORK_HOURS <= 8 , Ok, defaulter
)),
show.legend = T
) +
scale_color_manual(
labels = c("Default", "Success"),
values = c("red", "#0072B2")
) +
theme_bw(base_size = 15)  + theme(panel.background = element_rect(
linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed'
)) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())  +  scale_x_date(date_breaks = 'day',
date_labels = '%b %d\n%a')
ggplot(data = data_left_pgOne, aes(x = CONTACT_DATE,y = WORK_HOURS)) +
geom_point(
shape = 20,
size = 5,
aes(color = ifelse(
data_temp$WORK_HOURS <= 8 , Ok, defaulter
)),
show.legend = T
)
ggplot(data = data_left_pgOne, aes(x = CONTACT_DATE,y = WORK_HOURS))
geom_point(
shape = 20,
size = 5,
aes(color = ifelse(
WORK_HOURS <= 8 , Ok, defaulter
)),
show.legend = T
) +
scale_color_manual(
labels = c("Default", "Success"),
values = c("red", "#0072B2")
) +
theme_bw(base_size = 15)  + theme(panel.background = element_rect(
linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed'
)) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())  +  scale_x_date(date_breaks = 'day',
date_labels = '%b %d\n%a')
ggplot(data = data_left_pgOne, aes(x = CONTACT_DATE,y = WORK_HOURS)) +
geom_point(
shape = 20,
size = 5,
aes(color = ifelse(
WORK_HOURS <= 8 , Ok, defaulter
)),
show.legend = T
) +
scale_color_manual(
labels = c("Default", "Success"),
values = c("red", "#0072B2")
) +
theme_bw(base_size = 15)  + theme(panel.background = element_rect(
linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed'
)) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())  +  scale_x_date(date_breaks = 'day',
date_labels = '%b %d\n%a')
runApp()
runApp()
runApp()
ggplot(data = data_left_pgOne %>% filter(data_temp$AGENT_NAME == 'Sarmistha Barman'),
aes(x = CONTACT_DATE, y = WORK_HOURS)) +
geom_bar(fill = '#328770', col = "black", stat = "identity") +
theme_bw() + theme_minimal(base_size = 15) +   labs(x = '', y = 'Working Hours') +
labs(col = "Legend") +   geom_smooth(level = .65,
se = F,
colour = 'red') +
theme(panel.background = element_rect(linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed')) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "Legend")
ggplot(data = data_left_pgOne %>% filter(data_temp$AGENT_NAME == 'Sarmistha Barman'),
aes(x = CONTACT_DATE, y = WORK_HOURS))
ggplot(data = data_left_pgOne %>% filter(data_left_pgOne$AGENT_NAME == 'Sarmistha Barman'),
aes(x = CONTACT_DATE, y = WORK_HOURS)) +
geom_bar(fill = '#328770', col = "black", stat = "identity") +
theme_bw() + theme_minimal(base_size = 15) +   labs(x = '', y = 'Working Hours') +
labs(col = "Legend") +   geom_smooth(level = .65,
se = F,
colour = 'red') +
theme(panel.background = element_rect(linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed')) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "Legend")
ggplot(data = data_left_pgOne %>% filter(AGENT_NAME == 'Sarmistha Barman'),
aes(x = CONTACT_DATE, y = WORK_HOURS)) +
geom_bar(fill = '#328770', col = "black", stat = "identity") +
theme_bw() + theme_minimal(base_size = 15) +   labs(x = '', y = 'Working Hours') +
labs(col = "Legend") +   geom_smooth(level = .65,
se = F,
colour = 'red') +
theme(panel.background = element_rect(linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed')) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "Legend")
ggplot(data = data_left_pgOne %>% filter(AGENT_NAME == 'Sarmistha Barman'),
aes(x = CONTACT_DATE, y = WORK_HOURS)) +
geom_bar(fill = '#328770', col = "black", stat = "identity") +
theme_bw() + theme_minimal(base_size = 15) +   labs(x = '', y = 'Working Hours') +
labs(col = "Legend") +   geom_smooth(level = .65,
se = F,
colour = 'red',
method = 'loess',
formula = 'y ~ x^2') +
theme(panel.background = element_rect(linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed')) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "Legend")
ggplot(data = data_left_pgOne %>% filter(AGENT_NAME == 'Sarmistha Barman'),
aes(x = CONTACT_DATE, y = WORK_HOURS)) +
geom_bar(fill = '#328770', col = "black", stat = "identity") +
theme_bw() + theme_minimal(base_size = 15) +   labs(x = '', y = 'Working Hours') +
labs(col = "Legend") +   geom_smooth(level = .65,
se = F,
colour = 'red',
method = 'loess',
formula = 'y ~ x') +
theme(panel.background = element_rect(linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed')) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "Legend")
runApp()
ggplot(data = data_left_pgOne %>% filter(AGENT_NAME == 'Arnab Kumar Das'),
aes(x = CONTACT_DATE, y = WORK_HOURS)) +
geom_bar(fill = '#328770', col = "black", stat = "identity") +
theme_bw() + theme_minimal(base_size = 15) +   labs(x = '', y = 'Working Hours') +
labs(col = "Legend") +   geom_smooth(level = .65,
se = F,
colour = 'red',
method = 'loess',
formula = 'y ~ x') +
theme(panel.background = element_rect(linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed')) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "Legend")
ggplot(data = data_left_pgOne %>% filter(AGENT_NAME == 'Arnab Kumar Das'),
aes(x = CONTACT_DATE, y = WORK_HOURS)) +
geom_bar(fill = '#328770', col = "black", stat = "identity") +
theme_bw() + theme_minimal(base_size = 15) +   labs(x = '', y = 'Working Hours') +
labs(col = "Legend") +   geom_smooth(level = .65,
se = F,
colour = 'red',
method = 'loess',
formula = 'y ~ x') +
theme(panel.background = element_rect(linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed')) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "Legend") +
scale_x_date(date_breaks = 'day',
date_labels = '%b %d\n%a')
ggplot(data = data_left_pgOne %>% filter(AGENT_NAME == 'Arnab Kumar Das'),
aes(x = CONTACT_DATE, y = WORK_HOURS)) +
geom_bar(fill = '#328770', col = "black", stat = "identity") +
theme_bw() + theme_minimal(base_size = 15) +   labs(x = '', y = 'Working Hours') +
labs(col = "Legend") +   geom_smooth(level = .65,
se = F,
colour = 'red',
method = 'loess',
formula = 'y ~ x') +
theme(panel.background = element_rect(linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed')) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "Legend") +
scale_x_date(date_breaks = 'day',
date_labels = '%b %d')
ggplot(data = data_left_pgOne %>% filter(AGENT_NAME == 'Arnab Kumar Das'),
aes(x = CONTACT_DATE, y = WORK_HOURS)) +
geom_bar(fill = '#328770', col = "black", stat = "identity") +
theme_bw() + theme_minimal(base_size = 15) +   labs(x = '', y = 'Working Hours') +
labs(col = "Legend") +   geom_smooth(level = .65,
se = F,
colour = 'red',
method = 'loess',
formula = 'y ~ x') +
theme(panel.background = element_rect(linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed')) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "Legend") +
scale_x_date(date_breaks = 'day')
ggplot(data = data_left_pgOne %>% filter(AGENT_NAME == 'Arnab Kumar Das'),
aes(x = CONTACT_DATE, y = WORK_HOURS)) +
geom_bar(fill = '#328770', col = "black", stat = "identity") +
theme_bw() + theme_minimal(base_size = 15) +   labs(x = '', y = 'Working Hours') +
labs(col = "Legend") +   geom_smooth(level = .65,
se = F,
colour = 'red',
method = 'loess',
formula = 'y ~ x') +
theme(panel.background = element_rect(linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed')) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "Legend") +
scale_x_date(
date_labels = '%b %d')
ggplot(data = data_left_pgOne %>% filter(AGENT_NAME == 'Arnab Kumar Das'),
aes(x = CONTACT_DATE, y = WORK_HOURS)) +
geom_bar(fill = '#328770', col = "black", stat = "identity") +
theme_bw() + theme_minimal(base_size = 15) +   labs(x = '', y = 'Working Hours') +
labs(col = "Legend") +   geom_smooth(level = .65,
se = F,
colour = 'red',
method = 'loess',
formula = 'y ~ x') +
theme(panel.background = element_rect(linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed')) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "Legend") +
scale_x_date(
date_labels = '%b %d\n%a')
x = data_left_pgOne %>% filter(AGENT_NAME == 'Arnab Kumar Das'
)
x = data_left_pgOne %>% filter(AGENT_NAME == 'Arnab Kumar Das')
View(x)
ggplot(data = data_left_pgOne %>% filter(AGENT_NAME == 'Arnab Kumar Das'),
aes(x = CONTACT_DATE, y = WORK_HOURS)) +
geom_bar(fill = '#328770', col = "black", stat = "identity") +
theme_bw() + theme_minimal(base_size = 15) +   labs(x = '', y = 'Working Hours') +
labs(col = "Legend") +   geom_smooth(level = .65,
se = F,
colour = 'red',
method = 'loess',
formula = 'y ~ x') +
theme(panel.background = element_rect(linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed')) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "Legend")
ggplot(data = data_left_pgOne %>% filter(AGENT_NAME == 'Arnab Kumar Das'),
aes(x = CONTACT_DATE, y = WORK_HOURS)) +
geom_bar(fill = '#328770', col = "black", stat = "identity") +
theme_bw() + theme_minimal(base_size = 15) +   labs(x = '', y = 'Working Hours') +
labs(col = "Legend") +   geom_smooth(level = .65,
se = F,
colour = 'red',
method = 'loess',
formula = 'y ~ x') +
theme(panel.background = element_rect(linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed')) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "Legend")
runApp()
x = data_left_pgOne %>% filter(AGENT_NAME == 'Arnab Kumar Das')
x = data_left_pgOne %>% filter(AGENT_NAME == 'Arnab Kumar Das')
ggplot(data = data_left_pgOne %>% filter(AGENT_NAME == 'Arnab Kumar Das'),
aes(x = CONTACT_DATE, y = WORK_HOURS)) +
geom_bar(fill = '#328770', col = "black", stat = "identity",  width = 4) +
theme_bw() + theme_minimal(base_size = 15) +   labs(x = '', y = 'Working Hours') +
labs(col = "Legend") +   geom_smooth(level = .65,
se = F,
colour = 'red',
method = 'loess',
formula  = 'y ~ x') +
theme(panel.background = element_rect(linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed')) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "Legend")  +
scale_x_date(date_breaks = 'day', date_labels = '%b %d\n%a')
ggplot(data = data_left_pgOne %>% filter(AGENT_NAME == 'Arnab Kumar Das'),
aes(x = CONTACT_DATE, y = WORK_HOURS)) +
geom_bar(fill = '#328770', col = "black", stat = "identity",  width = 1) +
theme_bw() + theme_minimal(base_size = 15) +   labs(x = '', y = 'Working Hours') +
labs(col = "Legend") +   geom_smooth(level = .65,
se = F,
colour = 'red',
method = 'loess',
formula  = 'y ~ x') +
theme(panel.background = element_rect(linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed')) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "Legend")  +
scale_x_date(date_breaks = 'day', date_labels = '%b %d\n%a')
runApp()
ggplot(data = data_left_pgOne %>% filter(AGENT_NAME == 'Sanchita Dutta'),
aes(x = CONTACT_DATE, y = WORK_HOURS)) +
geom_bar(fill = '#328770', col = "black", stat = "identity",  width = 1) +
theme_bw() + theme_minimal(base_size = 15) +   labs(x = '', y = 'Working Hours') +
labs(col = "Legend") +   geom_smooth(level = .65,
se = F,
colour = 'red',
method = 'loess',
formula  = 'y ~ x') +
theme(panel.background = element_rect(linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed')) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "Legend")  +
scale_x_date(date_breaks = 'day', date_labels = '%b %d\n%a')
runApp()
runApp()
runApp()
runApp()
# ggplot to point plot the weekly performance of all the employees
ggplot(data = data_left_pgOne, aes(x = CONTACT_DATE,y = WORK_HOURS)) +
geom_point(shape = 20,size = 5,aes(color = ifelse( WORK_HOURS <= 8 , Ok, defaulter)),
show.legend = T
) +
scale_color_manual(labels = c("Default", "Success"), values = c("red", "#0072B2")) +
theme_bw(base_size = 15)  +
theme( panel.background = element_rect( linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed')) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())  +
scale_x_date(date_breaks = 'day', date_labels = '%b %d\n%a')
# ggplot to generate the barplot of employee performance over the week
ggplot(data = data_left_pgOne %>% filter(AGENT_NAME == input$text),
aes(x = CONTACT_DATE, y = WORK_HOURS)
) +
geom_bar(fill = '#328770', col = "black", stat = "identity",  width = 1) +
theme_bw() + theme_minimal(base_size = 15) +   labs(x = '', y = 'Working Hours') +
labs(col = "Legend") +   geom_smooth(level = .65,se = F, colour = 'red', method = 'loess',formula  = 'y ~ x') +
theme(panel.background = element_rect(linetype = 1, colour = 'black', size = 2,fill = '#e6e8ed')) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "Legend")  +
scale_x_date(date_breaks = 'day', date_labels = '%b %d\n%a')
# ggplot to generate the barplot of employee performance over the week
ggplot(data = data_left_pgOne %>% filter(AGENT_NAME == 'Arnab Kumar Das'),
aes(x = CONTACT_DATE, y = WORK_HOURS)
) +
geom_bar(fill = '#328770', col = "black", stat = "identity",  width = 1) +
theme_bw() + theme_minimal(base_size = 15) +   labs(x = '', y = 'Working Hours') +
labs(col = "Legend") +   geom_smooth(level = .65,se = F, colour = 'red', method = 'loess',formula  = 'y ~ x') +
theme(panel.background = element_rect(linetype = 1, colour = 'black', size = 2,fill = '#e6e8ed')) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "Legend")  +
scale_x_date(date_breaks = 'day', date_labels = '%b %d\n%a')
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp('~/sd')
install.packages("shinyjs")
runApp('~/sd')
runApp('~/sd')
runApp('~/sd')
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
?datatable
runApp()
runApp()
runApp()
runApp()
runApp()
