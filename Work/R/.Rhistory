theme(panel.background = element_rect(linetype = 1, colour = 'black', size = 2)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
theme(axis.text=element_blank())
# Create a basic bar
ggplot(m, aes(x="", y=value, fill=variable)) + geom_bar(stat="identity", width=1, col = 'black') +
coord_polar("y", start=0) +
geom_text(aes(label = paste0(round(value,0), "%")), position = position_stack(vjust = 0.5)) +
scale_fill_manual( labels = c("Connected", "Waiting", "Paused", "Deassign"),values = wes_palette(n=4, name="Cavalcanti1"))  +
labs(x = NULL, y = NULL, fill = NULL, title = "Work Shares") +
theme_bw() + theme_minimal(base_size = 15) +
theme(panel.background = element_rect(linetype = 1, colour = 'black', size = 2)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
theme(axis.text=element_blank())
names(wesanderson::wes_palettes)
# Create a basic bar
ggplot(m, aes(x="", y=value, fill=variable)) + geom_bar(stat="identity", width=1, col = 'black') +
coord_polar("y", start=0) +
geom_text(aes(label = paste0(round(value,0), "%")), position = position_stack(vjust = 0.5)) +
scale_fill_manual( labels = c("Connected", "Waiting", "Paused", "Deassign"),values = wes_palette(n=4, name="FantasticFox1"))  +
labs(x = NULL, y = NULL, fill = NULL, title = "Work Shares") +
theme_bw() + theme_minimal(base_size = 15) +
theme(panel.background = element_rect(linetype = 1, colour = 'black', size = 2)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
theme(axis.text=element_blank())
# Create a basic bar
ggplot(m, aes(x="", y=value, fill=variable)) + geom_bar(stat="identity", width=1, col = 'black') +
coord_polar("y", start=0) +
geom_text(aes(label = paste0(round(value,0), "%")), position = position_stack(vjust = 0.5)) +
scale_fill_manual( labels = c("Connected", "Waiting", "Paused", "Deassign"),values = wes_palette(n=4, name="Chevalier1"))  +
labs(x = NULL, y = NULL, fill = NULL, title = "Work Shares") +
theme_bw() + theme_minimal(base_size = 15) +
theme(panel.background = element_rect(linetype = 1, colour = 'black', size = 2)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
theme(axis.text=element_blank())
source('~/Work/BI_Reporting/Work/R/individual graph.R', echo=TRUE)
names(wesanderson::wes_palettes)
# Create a basic bar
ggplot(m, aes(x="", y=value, fill=variable)) + geom_bar(stat="identity", width=1, col = 'black') +
coord_polar("y", start=0) +
geom_text(aes(label = paste0(round(value,0), "%")), position = position_stack(vjust = 0.5)) +
scale_fill_manual( labels = c("Connected", "Waiting", "Paused", "Deassign"),values = wes_palette(n=4, name="BottleRocket2"))  +
labs(x = NULL, y = NULL, fill = NULL, title = "Work Shares") +
theme_bw() + theme_minimal(base_size = 15) +
theme(panel.background = element_rect(linetype = 1, colour = 'black', size = 2)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
theme(axis.text=element_blank())
# Create a basic bar
ggplot(m, aes(x="", y=value, fill=variable)) + geom_bar(stat="identity", width=1, col = 'black') +
coord_polar("y", start=0) +
geom_text(aes(label = paste0(round(value,0), "%")), position = position_stack(vjust = 0.5)) +
scale_fill_manual( labels = c("Connected", "Waiting", "Paused", "Deassign"),values = wes_palette(n=4, name="Rushmore1"))  +
labs(x = NULL, y = NULL, fill = NULL, title = "Work Shares") +
theme_bw() + theme_minimal(base_size = 15) +
theme(panel.background = element_rect(linetype = 1, colour = 'black', size = 2)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
theme(axis.text=element_blank())
# Create a basic bar
ggplot(m, aes(x="", y=value, fill=variable)) + geom_bar(stat="identity", width=1, col = 'black') +
coord_polar("y", start=0) +
geom_text(aes(label = paste0(round(value,0), "%")), position = position_stack(vjust = 0.5)) +
scale_fill_manual( labels = c("Connected", "Waiting", "Paused", "Deassign"),values = wes_palette(n=4, name="Rushmore2"))  +
labs(x = NULL, y = NULL, fill = NULL, title = "Work Shares") +
theme_bw() + theme_minimal(base_size = 15) +
theme(panel.background = element_rect(linetype = 1, colour = 'black', size = 2)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
theme(axis.text=element_blank())
# Create a basic bar
ggplot(m, aes(x="", y=value, fill=variable)) + geom_bar(stat="identity", width=1, col = 'black') +
coord_polar("y", start=0) +
geom_text(aes(label = paste0(round(value,0), "%")), position = position_stack(vjust = 0.5)) +
scale_fill_manual( labels = c("Connected", "Waiting", "Paused", "Deassign"),values = wes_palette(n=4, name="Rushmore"))  +
labs(x = NULL, y = NULL, fill = NULL, title = "Work Shares") +
theme_bw() + theme_minimal(base_size = 15) +
theme(panel.background = element_rect(linetype = 1, colour = 'black', size = 2)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
theme(axis.text=element_blank())
# Create a basic bar
ggplot(m, aes(x="", y=value, fill=variable)) + geom_bar(stat="identity", width=1, col = 'black') +
coord_polar("y", start=0) +
geom_text(aes(label = paste0(round(value,0), "%")), position = position_stack(vjust = 0.5)) +
scale_fill_manual( labels = c("Connected", "Waiting", "Paused", "Deassign"),values = wes_palette(n=4, name="Royal2"))  +
labs(x = NULL, y = NULL, fill = NULL, title = "Work Shares") +
theme_bw() + theme_minimal(base_size = 15) +
theme(panel.background = element_rect(linetype = 1, colour = 'black', size = 2)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
theme(axis.text=element_blank())
# Create a basic bar
ggplot(m, aes(x="", y=value, fill=variable)) + geom_bar(stat="identity", width=1, col = 'black') +
coord_polar("y", start=0) +
geom_text(aes(label = paste0(round(value,0), "%")), position = position_stack(vjust = 0.5)) +
scale_fill_manual( labels = c("Connected", "Waiting", "Paused", "Deassign"),values = wes_palette(n=4, name="Royal1"))  +
labs(x = NULL, y = NULL, fill = NULL, title = "Work Shares") +
theme_bw() + theme_minimal(base_size = 15) +
theme(panel.background = element_rect(linetype = 1, colour = 'black', size = 2)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
theme(axis.text=element_blank())
names(wesanderson::wes_palettes)
# Create a basic bar
ggplot(m, aes(x="", y=value, fill=variable)) + geom_bar(stat="identity", width=1, col = 'black') +
coord_polar("y", start=0) +
geom_text(aes(label = paste0(round(value,0), "%")), position = position_stack(vjust = 0.5)) +
scale_fill_manual( labels = c("Connected", "Waiting", "Paused", "Deassign"),values = wes_palette(n=4, name="Zissou1"))  +
labs(x = NULL, y = NULL, fill = NULL, title = "Work Shares") +
theme_bw() + theme_minimal(base_size = 15) +
theme(panel.background = element_rect(linetype = 1, colour = 'black', size = 2)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
theme(axis.text=element_blank())
# Create a basic bar
ggplot(m, aes(x="", y=value, fill=variable)) + geom_bar(stat="identity", width=1, col = 'black') +
coord_polar("y", start=0) +
geom_text(aes(label = paste0(round(value,0), "%")), position = position_stack(vjust = 0.5)) +
scale_fill_manual( labels = c("Connected", "Waiting", "Paused", "Deassign"),values = wes_palette(n=4, name="Darjeeling1"))  +
labs(x = NULL, y = NULL, fill = NULL, title = "Work Shares") +
theme_bw() + theme_minimal(base_size = 15) +
theme(panel.background = element_rect(linetype = 1, colour = 'black', size = 2)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
theme(axis.text=element_blank())
# Create a basic bar
ggplot(m, aes(x="", y=value, fill=variable)) + geom_bar(stat="identity", width=1, col = 'black') +
coord_polar("y", start=0) +
geom_text(aes(label = paste0(round(value,0), "%")), position = position_stack(vjust = 0.5)) +
scale_fill_manual( labels = c("Connected", "Waiting", "Paused", "Deassign"),values = wes_palette(n=4, name="Darjeeling2"))  +
labs(x = NULL, y = NULL, fill = NULL, title = "Work Shares") +
theme_bw() + theme_minimal(base_size = 15) +
theme(panel.background = element_rect(linetype = 1, colour = 'black', size = 2)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
theme(axis.text=element_blank())
runApp('Work/BI_Reporting/Work/R')
x = data_left_pgOne %>% filter(AGENT_NAME == (input$datatable_one_cell_clicked)[3] %>% summarize(n()))
x = data_left_pgOne %>% filter(AGENT_NAME == 'fdjh') %>% summarize(n())
View(x)
View(data_left_pgOne)
x = data_left_pgOne %>% filter(AGENT_NAME == 'fdjh') %>% summarise(count = sum(WORK_HOURS))
View(x)
x = data_left_pgOne %>% filter(AGENT_NAME == 'fdjh') %>% mutate(count = ifelse(is.na(count), 0, count))
x = data_left_pgOne %>% filter(AGENT_NAME == 'fdjh') %>% summarise(count = sum(WORK_HOURS)) %>% mutate(count = ifelse(is.na(count), 0, count))
View(x)
over_perf <- data_temp %>%
select(TOTAL_CONNECTED_IN_HRS,TOTAL_WAITING_IN_HRS, TOTAL_PAUSED_IN_HRS, TOTAL_DEASSIGN_IN_HRS)  %>%
summarise_all(funs(sum))
x = data_left_pgOne %>% filter(AGENT_NAME == 'fdjh')
x$WORK_HOURS
x$AGENT_NAME
x = data_left_pgOne %>% filter(AGENT_NAME == 'fdjh')
is.na(x$AGENT_NAME)
x$AGENT_NAME
# fetch all data from  daily_noble_data_fact
data_temp  = sqlQuery(connHandle, "
SELECT DA.AGENT_NAME,DW.WEEK_DAY,DS.SHIFT_TYPE,DF.CONTACT_DATE,TOTAL_CONNECTED_IN_HRS,
TOTAL_WAITING_IN_HRS, TOTAL_PAUSED_IN_HRS, TOTAL_DEASSIGN_IN_HRS,
TOTAL_SUMMARY_IN_HRS, TOTAL_CONNECTED_IN_MINS, TOTAL_WAITING_IN_MINS,
TOTAL_PAUSED_IN_MINS, TOTAL_DEASSIGN_IN_MINS, TOTAL_SUMMARY_IN_MINS
FROM
DIM_AGENT DA,
DIM_SHIFTS DS,
DIM_WEEKS DW,
DAILY_NOBLE_DATA_FACT DF
WHERE
DF.AGENT_ID =DA.AGENT_ID
AND DS.SHIFT_ID=DF.SHIFT_ID
AND DW.WEEK_ID = DF.WEEK_ID
AND DF.CONTACT_DATE >= TO_DATE(SYSDATE - 7, 'MM/DD/YYYY');",stringsAsFactors = F
)
# Chanege the date Oracle format to R date
data_temp$CONTACT_DATE <- as.Date(data_temp$CONTACT_DATE, "%m/%d/%Y")
# aggregating the data for the second tab
data_left_pgOne <-  data_temp %>%
select (.,AGENT_NAME,TOTAL_SUMMARY_IN_HRS,CONTACT_DATE) %>%
group_by(AGENT_NAME, CONTACT_DATE) %>%
summarise(WORK_HOURS = sum(TOTAL_SUMMARY_IN_HRS, na.rm = TRUE))
data_right_pgOne <-  data_temp %>%
select (.,AGENT_NAME,TOTAL_CONNECTED_IN_HRS,
TOTAL_WAITING_IN_HRS, TOTAL_PAUSED_IN_HRS,
TOTAL_DEASSIGN_IN_HRS,TOTAL_SUMMARY_IN_HRS,CONTACT_DATE) %>%
group_by(AGENT_NAME, CONTACT_DATE) %>%
summarise(WORK_HOURS = sum(TOTAL_SUMMARY_IN_HRS, na.rm = TRUE))
# variable for conditional coloring at ggplot
defaulter <- "Red"
Ok <- "blue"
# ggplot to point plot the weekly performance of all the employees
ggplot(data = data_left_pgOne, aes(x = CONTACT_DATE,y = WORK_HOURS)) +
geom_point(shape = 20,size = 5,aes(color = ifelse( WORK_HOURS <= 8 , Ok, defaulter)),
show.legend = T
) +
scale_color_manual(labels = c("Default", "Success"), values = c("red", "#0072B2")) +
theme_bw(base_size = 15)  +
theme( panel.background = element_rect( linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed')) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())  +
scale_x_date(date_breaks = 'day', date_labels = '%b %d\n%a')
# ggplot to generate the barplot of employee performance over the week
ggplot(data = data_left_pgOne %>% filter(AGENT_NAME == 'Arnab Kumar Das'),
aes(x = CONTACT_DATE, y = WORK_HOURS)
) +
geom_bar(fill = '#328770', col = "black", stat = "identity",  width = 1) +
theme_bw() + theme_minimal(base_size = 15) +   labs(x = '', y = 'Working Hours') +
labs(col = "Legend") +   geom_smooth(level = .65,se = F, colour = 'red', method = 'loess',formula  = 'y ~ x') +
theme(panel.background = element_rect(linetype = 1, colour = 'black', size = 2,fill = '#e6e8ed')) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "Legend")  +
scale_x_date(date_breaks = 'day', date_labels = '%b %d\n%a')
x = data_left_pgOne %>% filter(AGENT_NAME == 'fdjh')
x$AGENT_NAME
print(x$AGENT_NAME)
# fetch all data from  daily_noble_data_fact
data_temp  = sqlQuery(connHandle, "
SELECT DA.AGENT_NAME,DW.WEEK_DAY,DS.SHIFT_TYPE,DF.CONTACT_DATE,TOTAL_CONNECTED_IN_HRS,
TOTAL_WAITING_IN_HRS, TOTAL_PAUSED_IN_HRS, TOTAL_DEASSIGN_IN_HRS,
TOTAL_SUMMARY_IN_HRS, TOTAL_CONNECTED_IN_MINS, TOTAL_WAITING_IN_MINS,
TOTAL_PAUSED_IN_MINS, TOTAL_DEASSIGN_IN_MINS, TOTAL_SUMMARY_IN_MINS
FROM
DIM_AGENT DA,
DIM_SHIFTS DS,
DIM_WEEKS DW,
DAILY_NOBLE_DATA_FACT DF
WHERE
DF.AGENT_ID =DA.AGENT_ID
AND DS.SHIFT_ID=DF.SHIFT_ID
AND DW.WEEK_ID = DF.WEEK_ID
AND DF.CONTACT_DATE >= TO_DATE(SYSDATE - 7, 'MM/DD/YYYY');",stringsAsFactors = T
)
# aggregating the data for the second tab
data_left_pgOne <-  data_temp %>%
select (.,AGENT_NAME,TOTAL_SUMMARY_IN_HRS,CONTACT_DATE) %>%
group_by(AGENT_NAME, CONTACT_DATE) %>%
summarise(WORK_HOURS = sum(TOTAL_SUMMARY_IN_HRS, na.rm = TRUE))
# Chanege the date Oracle format to R date
data_temp$CONTACT_DATE <- as.Date(data_temp$CONTACT_DATE, "%m/%d/%Y")
data_right_pgOne <-  data_temp %>%
select (.,AGENT_NAME,TOTAL_CONNECTED_IN_HRS,
TOTAL_WAITING_IN_HRS, TOTAL_PAUSED_IN_HRS,
TOTAL_DEASSIGN_IN_HRS,TOTAL_SUMMARY_IN_HRS,CONTACT_DATE) %>%
group_by(AGENT_NAME, CONTACT_DATE) %>%
summarise(WORK_HOURS = sum(TOTAL_SUMMARY_IN_HRS, na.rm = TRUE))
# variable for conditional coloring at ggplot
defaulter <- "Red"
Ok <- "blue"
# ggplot to point plot the weekly performance of all the employees
ggplot(data = data_left_pgOne, aes(x = CONTACT_DATE,y = WORK_HOURS)) +
geom_point(shape = 20,size = 5,aes(color = ifelse( WORK_HOURS <= 8 , Ok, defaulter)),
show.legend = T
) +
scale_color_manual(labels = c("Default", "Success"), values = c("red", "#0072B2")) +
theme_bw(base_size = 15)  +
theme( panel.background = element_rect( linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed')) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())  +
scale_x_date(date_breaks = 'day', date_labels = '%b %d\n%a')
# ggplot to generate the barplot of employee performance over the week
ggplot(data = data_left_pgOne %>% filter(AGENT_NAME == 'Arnab Kumar Das'),
aes(x = CONTACT_DATE, y = WORK_HOURS)
) +
geom_bar(fill = '#328770', col = "black", stat = "identity",  width = 1) +
theme_bw() + theme_minimal(base_size = 15) +   labs(x = '', y = 'Working Hours') +
labs(col = "Legend") +   geom_smooth(level = .65,se = F, colour = 'red', method = 'loess',formula  = 'y ~ x') +
theme(panel.background = element_rect(linetype = 1, colour = 'black', size = 2,fill = '#e6e8ed')) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
labs(x = '', y = 'WORK_HOURS') + labs(col = "Legend")  +
scale_x_date(date_breaks = 'day', date_labels = '%b %d\n%a')
x = data_left_pgOne %>% filter(AGENT_NAME == 'fdjh')
tover_perf <- data_temp %>%
select(TOTAL_CONNECTED_IN_HRS,TOTAL_WAITING_IN_HRS, TOTAL_PAUSED_IN_HRS, TOTAL_DEASSIGN_IN_HRS)  %>%
summarise_all(funs(sum))
length(x)
nrow(x)
runApp('Work/BI_Reporting/Work/R')
runApp('Work/BI_Reporting/Work/R')
shiny::runApp()
strsplit('TOTAL_WAITING_IN_HRS', '_')
strsplit('TOTAL_WAITING_IN_HRS', '_')[1][2]
strsplit('TOTAL_WAITING_IN_HRS', '_')[2]
strsplit('TOTAL_WAITING_IN_HRS', '_')
strsplit('TOTAL_WAITING_IN_HRS', '_')[[1]]
strsplit('TOTAL_WAITING_IN_HRS', '_')[[1]][2]
runApp()
runApp()
m
strsplit(m$variable, '_')[[1]][2]
m$variable
sapply(strsplit(m$variable,'_')[[1]][2])
sapply(strsplit(m$variable,'_')[[1]][2],head,1)
sapply(strsplit(m$variable,'_'),head,1)
TOTAL_WAITING_IN_HRS
TOTAL_WAITING_IN_HRS
runApp()
runApp()
View(over_perf)
View(data_right_pgOne)
View(data_temp)
View(data_left_pgOne)
View(data_right_pgOne)
View(data_temp)
View(data_temp)
KPI_perf_overall <- data_temp %>%
select(TOTAL_CONNECTED_IN_HRS,TOTAL_WAITING_IN_HRS, TOTAL_PAUSED_IN_HRS, TOTAL_DEASSIGN_IN_HRS,SHIFT_TYPE,WEEK_DAY,AGENT_NAME)  %>%
group_by(SHIFT_TYPE,WEEK_DAY,AGENT_NAME)  %>%  summarise_all(funs(sum))
View(KPI_perf_overall)
KPI_perf_overall <- data_temp %>%
select(c(TOTAL_CONNECTED_IN_HRS,TOTAL_WAITING_IN_HRS, TOTAL_PAUSED_IN_HRS, TOTAL_DEASSIGN_IN_HRS,SHIFT_TYPE,WEEK_DAY,AGENT_NAME))  %>%
group_by(SHIFT_TYPE,WEEK_DAY,AGENT_NAME)  %>%  summarise_all(funs(sum))
View(KPI_perf_overall)
KPI_perf_overall <- data_temp %>%
select(c(TOTAL_CONNECTED_IN_HRS,TOTAL_WAITING_IN_HRS, TOTAL_PAUSED_IN_HRS, TOTAL_DEASSIGN_IN_HRS,SHIFT_TYPE,WEEK_DAY,AGENT_NAME))  %>%
group_by(c(SHIFT_TYPE,WEEK_DAY,AGENT_NAME))  %>%  summarise_all(funs(sum))
KPI_perf_overall <- data_temp %>%
select(c(TOTAL_CONNECTED_IN_HRS,TOTAL_WAITING_IN_HRS, TOTAL_PAUSED_IN_HRS, TOTAL_DEASSIGN_IN_HRS,SHIFT_TYPE,WEEK_DAY,AGENT_NAME))  %>%
group_by(SHIFT_TYPE,WEEK_DAY,AGENT_NAME)  %>%  summarise_all(funs(sum))
runApp()
KPI_perf_overall <- data_temp %>%
select(c(TOTAL_CONNECTED_IN_HRS,TOTAL_WAITING_IN_HRS, TOTAL_PAUSED_IN_HRS, TOTAL_DEASSIGN_IN_HRS,SHIFT_TYPE,WEEK_DAY))  %>%
group_by(SHIFT_TYPE,WEEK_DAY)  %>%  summarise_all(funs(sum))
View(data_temp)
runApp()
runApp()
KPI_perf_overall <- data_temp %>%
select(c(TOTAL_CONNECTED_IN_HRS,TOTAL_WAITING_IN_HRS, TOTAL_PAUSED_IN_HRS, TOTAL_DEASSIGN_IN_HRS,SHIFT_TYPE,WEEK_DAY))  %>%
group_by_at(c(SHIFT_TYPE,WEEK_DAY))  %>%  summarise_all(funs(sum))
KPI_perf_overall <- data_temp %>%
select(TOTAL_CONNECTED_IN_HRS,TOTAL_WAITING_IN_HRS, TOTAL_PAUSED_IN_HRS, TOTAL_DEASSIGN_IN_HRS,SHIFT_TYPE,WEEK_DAY,AGENT_NAME)  %>%
group_by_at(SHIFT_TYPE,WEEK_DAY,AGENT_NAME)  %>%  summarise_all(funs(sum))
data_temp$SHIFT_TYPE
KPI_perf_overall <- data_temp %>%
select(TOTAL_CONNECTED_IN_HRS,TOTAL_WAITING_IN_HRS, TOTAL_PAUSED_IN_HRS, TOTAL_DEASSIGN_IN_HRS,SHIFT_TYPE,WEEK_DAY,AGENT_NAME)  %>%
group_by_at(SHIFT_TYPE,WEEK_DAY,AGENT_NAME)  %>%  summarise_all(funs(sum))
KPI_perf_overall <- data_temp %>%
select(SHIFT_TYPE,WEEK_DAY,AGENT_NAME,TOTAL_CONNECTED_IN_HRS,TOTAL_WAITING_IN_HRS, TOTAL_PAUSED_IN_HRS, TOTAL_DEASSIGN_IN_HRS)  %>%
group_by_at(SHIFT_TYPE,WEEK_DAY,AGENT_NAME)  %>%
summarise_all(funs(sum))
KPI_perf_overall <- data_temp %>%
select(SHIFT_TYPE,WEEK_DAY,AGENT_NAME,TOTAL_CONNECTED_IN_HRS,TOTAL_WAITING_IN_HRS, TOTAL_PAUSED_IN_HRS, TOTAL_DEASSIGN_IN_HRS)  %>%
group_by_at(SHIFT_TYPE,WEEK_DAY,AGENT_NAME) # %>%
KPI_perf_overall <- data_temp %>%
select(SHIFT_TYPE,WEEK_DAY,AGENT_NAME,TOTAL_CONNECTED_IN_HRS,TOTAL_WAITING_IN_HRS, TOTAL_PAUSED_IN_HRS, TOTAL_DEASSIGN_IN_HRS)  %>%
group_by(SHIFT_TYPE,WEEK_DAY,AGENT_NAME) # %>%
KPI_perf_overall <- data_temp %>%
select(SHIFT_TYPE,WEEK_DAY,AGENT_NAME,TOTAL_CONNECTED_IN_HRS,TOTAL_WAITING_IN_HRS, TOTAL_PAUSED_IN_HRS, TOTAL_DEASSIGN_IN_HRS)  %>%
group_by(SHIFT_TYPE,WEEK_DAY,AGENT_NAME)  %>% summarise_all(funs(sum))
View(KPI_perf_overall)
dynamic_data <- KPI_perf_overall %>% select_(list_cols)
list_cols <- c('SHIFT_TYPE','WEEK_DAY')
dynamic_data <- KPI_perf_overall %>% select_(list_cols)
View(dynamic_data)
list_cols <- c('SHIFT_TYPE','WEEK_DAY','TOTAL_CONNECTED_IN_HRS','TOTAL_WAITING_IN_HRS', 'TOTAL_PAUSED_IN_HRS', 'TOTAL_DEASSIGN_IN_HRS')
dynamic_data <- KPI_perf_overall %>% select_(list_cols)
dynamic_data <- KPI_perf_overall %>% select_(list_cols)
View(dynamic_data)
dynamics_data <- KPI_perf_overall %>% select_(list_cols)
View(dynamics_data)
View(KPI_perf_overall)
dynamics_data <- KPI_perf_overall %>% select_(.dots = list('SHIFT_TYPE','WEEK_DAY','TOTAL_CONNECTED_IN_HRS','TOTAL_WAITING_IN_HRS', 'TOTAL_PAUSED_IN_HRS', 'TOTAL_DEASSIGN_IN_HRS'))
dynamics_data <- KPI_perf_overall %>% select_(.dots = list('SHIFT_TYPE','WEEK_DAY','TOTAL_CONNECTED_IN_HRS','TOTAL_WAITING_IN_HRS', 'TOTAL_PAUSED_IN_HRS', 'TOTAL_DEASSIGN_IN_HRS'))
dynamic_data <- KPI_perf_overall %>% select_(.dots = list('SHIFT_TYPE','WEEK_DAY','TOTAL_CONNECTED_IN_HRS','TOTAL_WAITING_IN_HRS', 'TOTAL_PAUSED_IN_HRS', 'TOTAL_DEASSIGN_IN_HRS'))
select_var <- c(group_var,list('SHIFT_TYPE','WEEK_DAY','TOTAL_CONNECTED_IN_HRS','TOTAL_WAITING_IN_HRS', 'TOTAL_PAUSED_IN_HRS', 'TOTAL_DEASSIGN_IN_HRS'))
group_var <- list('SHIFT_TYPE','WEEK_DAY')
select_var <- c(group_var,list('SHIFT_TYPE','WEEK_DAY','TOTAL_CONNECTED_IN_HRS','TOTAL_WAITING_IN_HRS', 'TOTAL_PAUSED_IN_HRS', 'TOTAL_DEASSIGN_IN_HRS'))
dynamic_data <- KPI_perf_overall %>%
select_(.dots = select_var) %>%
group_by_(.dots = group_var)
group_var <- list('SHIFT_TYPE','WEEK_DAY')
values_var <- list('SHIFT_TYPE','WEEK_DAY','TOTAL_CONNECTED_IN_HRS','TOTAL_WAITING_IN_HRS', 'TOTAL_PAUSED_IN_HRS', 'TOTAL_DEASSIGN_IN_HRS')
select_var <- c(group_var,values_var)
unlist(values_var)
values_var
dynamic_data <- KPI_perf_overall %>%
select_(.dots = select_var) %>%
group_by_(.dots = group_var) %>%
summarise_all(funs(sum)) %>%
reshape2::melt(., measure.vars = unlist(values_var))
View(dynamic_data)
dynamic_data <- KPI_perf_overall %>%
select_(.dots = select_var) %>%
group_by_(.dots = group_var) %>%
summarise_all(funs(sum))
dynamic_data <- KPI_perf_overall %>%
select_(.dots = select_var) %>%
group_by_(.dots = group_var) %>%
summarise_all(funs(sum))%>%
reshape2::melt(., id.vars = unlist(select_var), measure.vars = unlist(values_var))
dynamic_data <- KPI_perf_overall %>%
select_(.dots = select_var) %>%
group_by_(.dots = group_var) %>%
summarise_all(funs(sum))
View(dynamic_data)
reshape2::melt(., id.vars = select_var, measure.vars = values_var)
melted_data <-  reshape2::melt(dynamic_data, id.vars = select_var, measure.vars = values_var)
View(melted_data)
melted_data <-  reshape2::melt(dynamic_data, measure.vars = c('SHIFT_TYPE','WEEK_DAY','TOTAL_CONNECTED_IN_HRS','TOTAL_WAITING_IN_HRS', 'TOTAL_PAUSED_IN_HRS', 'TOTAL_DEASSIGN_IN_HRS'))
group_var <- list('SHIFT_TYPE','WEEK_DAY')
values_var <- list('TOTAL_CONNECTED_IN_HRS','TOTAL_WAITING_IN_HRS', 'TOTAL_PAUSED_IN_HRS', 'TOTAL_DEASSIGN_IN_HRS')
select_var <- c(group_var,values_var)
dynamic_data <- KPI_perf_overall %>%
select_(.dots = select_var) %>%
group_by_(.dots = group_var) %>% select()
summarise_all(funs(sum))
dynamic_data <- KPI_perf_overall %>%
select_(.dots = select_var) %>%
group_by_(.dots = group_var) %>%
summarise_all(funs(sum))
melted_data <-  reshape2::melt(dynamic_data, measure.vars = unlist(values_var))
dynamic_data <- KPI_perf_overall %>%
select_(.dots = select_var) %>%
group_by_(.dots = group_var) %>%
summarise_all(funs(sum))  %>%  select_(.dots = values_var)
dynamic_data <- KPI_perf_overall %>%
select_(.dots = select_var) %>%
group_by_(.dots = group_var) %>%
summarise_all(funs(sum))  %>%  select_(.dots = values_var)
dynamic_data <- KPI_perf_overall %>%
select_(.dots = select_var) %>%
group_by_(.dots = group_var) %>%
summarise_all(funs(sum))  %>% ungroup() %>%   select_(.dots = values_var)
# if no rows returned from the filtered selection (on click) display an overall pie chart
ggplot(dynamic_data, aes(x="", y=value*2, fill=variable)) +
geom_bar(stat="identity", width=1, col = 'black') + coord_polar("y", start=0,clip = "on") +
geom_text(aes(label = paste0(round(value,0), "%")), position = position_stack(vjust = 0.5)) +
scale_fill_manual( labels = c("Connected", "Waiting", "Paused", "Deassign"),
values = wes_palette(n=4, name="Darjeeling2"))  +
theme_bw(base_size = 15)  +
labs(x = NULL, y = NULL, fill = NULL) +
labs(col = "Legend")  +
theme(panel.background = element_rect(linetype = 1,
colour = 'black',
size = 2,
fill = '#e6e8ed')) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
theme(axis.text=element_blank()) +
theme(legend.position="bottom")
dynamic_data <- KPI_perf_overall %>%
select_(.dots = select_var) %>%
group_by_(.dots = group_var) %>%
summarise_all(funs(sum))  %>% ungroup() %>%   select_(.dots = values_var) %>%
reshape2::melt(dynamic_data, measure.vars = unlist(values_var))
dynamic_data <- KPI_perf_overall %>%
select_(.dots = select_var) %>%
group_by_(.dots = group_var) %>%
summarise_all(funs(sum))  %>% ungroup() %>%   select_(.dots = values_var)
dynamic_data <- reshape2::melt(dynamic_data, measure.vars = unlist(values_var))
dynamic_data <- KPI_perf_overall %>%
select_(.dots = select_var) %>%
group_by_(.dots = group_var) %>%
summarise_all(funs(sum))  %>% ungroup() %>%   select_(.dots = values_var)
dynamic_data <- KPI_perf_overall %>%
select_(.dots = select_var) %>%
group_by_(.dots = group_var) %>%
summarise_all(funs(sum))
-----------------------------------------------------------------------------------------------------------------------
library(purrr)
install.packages('purr')
-----------------------------------------------------------------------------------------------------------------------
library(purrr)
install.packages('purrr')
install.packages("purrr")
install.packages("purrr")
install.packages("purrr")
install.packages("purrr")
install.packages("purrr")
-----------------------------------------------------------------------------------------------------------------------
library(purrr)
-----------------------------------------------------------------------------------------------------------------------
library(purrr)
install.packages("purrr")
install.packages("purrr")
-----------------------------------------------------------------------------------------------------------------------
library(purrr)
install.packages("lazyeval")
install.packages("lazyeval")
?filter_
?dplyr::filter_
dynamic_data <- KPI_perf_overall %>%
select_(.dots = select_var) %>%
group_by_(.dots = group_var) %>%
summarise_all(funs(sum))   %>%
filter_(.dots = paste0(group_var, "=='", filter_val, "'"))
paste0(group_var, "=='", filter_val, "'")
filter_val <- c('Afternoon','Friday')
dynamic_data <- KPI_perf_overall %>%
select_(.dots = select_var) %>%
group_by_(.dots = group_var) %>%
summarise_all(funs(sum))   %>%
filter_(.dots = paste0(group_var, "=='", filter_val, "'"))
paste0(group_var, "=='", filter_val, "'")
dynamic_data <- KPI_perf_overall %>%
select_(.dots = select_var) %>%
group_by_(.dots = group_var) %>%
summarise_all(funs(sum))   %>%
filter_(.,.dots = paste0(group_var, "=='", filter_val, "'"))
dynamic_data <- KPI_perf_overall %>%
select_(.dots = select_var) %>%
group_by_(.dots = group_var) %>%
summarise_all(funs(sum))   %>% select(everything()) %>%
filter_(.,.dots = paste0(group_var, "=='", filter_val, "'"))
dynamic_data <- KPI_perf_overall %>%
select_(.dots = select_var) %>%
group_by_(.dots = group_var) %>%
summarise_all(funs(sum))   %>% select(everything())
dynamic_data <- KPI_perf_overall %>%
select_(.dots = select_var) %>%
group_by_(.dots = group_var) %>%
summarise_all(funs(sum))
dynamic_data <- KPI_perf_overall %>%
select_(.dots = select_var) %>%
group_by_(.dots = group_var) %>%
summarise_all(funs(sum))
KPI_perf_overall <- data_temp %>%
select(SHIFT_TYPE,WEEK_DAY,AGENT_NAME,TOTAL_CONNECTED_IN_HRS,TOTAL_WAITING_IN_HRS, TOTAL_PAUSED_IN_HRS, TOTAL_DEASSIGN_IN_HRS)  %>%
group_by(SHIFT_TYPE,WEEK_DAY,AGENT_NAME)  %>% summarise_all(funs(sum))
